{% extends "base.html" %}
{% load static %}
{{ form.media }}
{% load permissions %}
{% block title %}Upravit noty | Sheet Music DB{% endblock %}
{% block content %}
    <div class="container-lg justify-content-center flex w-50 w-md-75 w-sm-100">
        <h1>Upravit noty</h1>
        <form method="post" enctype="multipart/form-data" class="d-flex flex-column gap-3">
            {% csrf_token %}
            <div class="title_input">
                <label for="title" class="form-label"><strong>Název skladby</strong></label>
                <input type="text" name="title" id="title" class="form-control" required value="{{ sheet.title }}">
            </div>
            <div class="composer_input">
                <label for="composer" class="form-label"><strong>Skladatel</strong></label>
                <input type="text" name="composer" id="composer" class="form-control" required value="{{ sheet.composer }}">
            </div>
            <div class="cast_input">
                <label for="cast" class="form-label"><strong>Obsazení</strong></label>
                <select class="form-select" id="cast" name="cast" required>
                    <option value="" selected disabled>Vyberte obsazení...</option>
                    {% for cast_code, cast_name in cast_choices %}
                        <option value="{{ cast_code }}" {% if cast_code|stringformat:"s" == sheet.cast|stringformat:"s" %}selected{% endif %}>{{ cast_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="season_input">
                <label for="season" class="form-label"><strong>Období</strong></label>
                <select class="form-select" id="season" name="season" required>
                    <option value="" selected disabled>Vyberte liturgické období...</option>
                    {% for season_code, season_name in season_choices %}
                        <option value="{{ season_code }}" {% if season_code|stringformat:"s" == sheet.season|stringformat:"s" %}selected{% endif %}>{{ season_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="use_input">
                <label for="use" class="form-label"><strong>Liturgická příležitost</strong></label>
                <select class="form-select" id="use" name="use" required>
                    <option value="" selected disabled>Vyberte liturgickou příležitost...</option>
                    {% for use_code, use_name in use_choices %}
                        <option value="{{ use_code }}" {% if use_code|stringformat:"s" == sheet.use|stringformat:"s" %}selected{% endif %}>{{ use_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="publication_year_input">
                <label for="publication_year" class="form-label"><strong>Rok vydání</strong></label>
                <input type="number" name="publication_year" id="publication_year" class="form-control" value="{{ sheet.publication_year }}">
            </div>
            <div class="publisher_input">
                <label for="publisher" class="form-label"><strong>Vydavatel</strong></label>
                <input type="text" name="publisher" id="publisher" class="form-control" value="{{ sheet.publisher }}">
            </div> 
            <div class="isbn_input">
                <label for="isbn" class="form-label"><strong>ISBN</strong> <i class="bi bi-barcode"></i></label>
                <input type="text" name="isbn" id="isbn" class="form-control" value="{{ sheet.isbn }}">
            </div>
            <div class="description_input">
                <label for="description" class="form-label"><i class="bi bi-info-circle"></i> <strong>Popis</strong></label>
                <textarea name="description" id="description" class="form-control">{{ sheet.description }}</textarea>
            </div>
            <div class="tags_input">
                <label for="tags" class="form-label"><i class="bi bi-tag"></i> <strong>Tagy</strong></label>
                <input type="text" name="tags" id="tags" class="form-control" value="{{ tags_csv }}" placeholder="oddělené čárkou, např. church, svatba, advent">
                <div class="form-text">Přidejte krátké štítky pro snadnější vyhledávání. Oddělujte čárkou.</div>
            </div>
            <div class="public_input">
                <label for="public" class="form-label"><i class="bi bi-eye"></i> <strong>Veřejné?</strong></label>
                <input type="checkbox" name="public" id="public" class="form-check" {% if sheet.public %}checked{% endif %}>
            </div>
            <div class="preview_image_input">
                <label for="preview_image" class="form-label"><i class="bi bi-image"></i> <strong>Náhledový obrázek</strong></label>
                <input type="file" name="preview_image" id="preview_image" class="form-control">
                {% if sheet.preview_image %}
                <p class="mt-2">Aktuální obrázek: <a href="{{ sheet.preview_image.url }}" target="_blank">{{ sheet.preview_image.name }}</a></p>
                {% endif %}
            </div>
            <div class="sheet_file_input">
                <label for="sheet_file" class="form-label"><i class="bi bi-music-note-list"></i> <strong>Soubor s notami</strong></label>
                <input type="file" name="sheet_file" id="sheet_file" class="form-control">
                {% if sheet.sheet_file %}
                <p class="mt-2">Aktuální soubor: <a href="{{ sheet.sheet_file.url }}" target="_blank">{{ sheet.sheet_file.name }}</a></p>
                {% endif %}
            </div>
            <button type="submit" class="submit-button btn btn-primary">Uložit změny</button>
            <a class="btn btn-outline-danger" href="{% url 'home' %}">Zpět</a>
        </form>
    </div>
{% endblock %}
{% block extra_js %}
<script></script>
{% endblock %}